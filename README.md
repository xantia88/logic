# Логическое программирование и управление архитектурой

Логическое программирование - одна из парадигм программирования, которая применяется для решения узкоспециализированных задач. Логические задачи сложно и неэффективно решать с помощью широко известных инструментов и подходов к разработке ПО, таких как ООП или процедурное программирование. При этом задачи, которые легко решаются с помощью широко известных подходов даже не стоит пытаться решать с помощью логического программирования (например: системная интеграция, обработка данных). Для каждой задачи - свой инструмент. Логическое программирование - одна из дисциплин теории искусственного интеллекта, т.к. задачей искусственного интеллекта является принятие решений, а решения принимаются на основе логики. Машинное обучение так же являетя одной из дисциплин искусственного интелекта, но специализируется не на логике, а на данных. 

При использовании стандартного к разработке ПО возникает естественное разделение между данными и кодом для их обработки. Данные, код обработки данных и код интерпретации данных становятся разными частями программы. При использование логического программирования код программы (а вернее сказать - логическая модель) является одновременно и данными и методом запросов. Такой подход известен как "data as code" и присущ только системам логического программирования, построенным на математическом аппарате известном как логика предикатов.

Если рассмотреть задачу "Архитектура как код", то возникает резонный вопрос - почему как код и в чем отличие от подхода "Архитектура как данные" ? Управление архитектурой как данными - задача уже решенная, достаточо выбрать решение и настроить сбор данных внутри компании, или создать свое решение. Код - это набор инструкций, которые можно выполнить и получить что-то полезное для себя. Данные - это информация, которую можно обрабаотать с помощью внешних средств и получить что-то полезное для себя. Подход к архитектуре как к данным превращается в сложные и кастомизированные под конкретную организацию и ее процессы системы с хранилищем данных, обработчиками данных, аналилитечскими отчетами и визуальными формами ввода. Применение технологий, основанных на логике, позволяет воспользоваться  изначально заложенным в логическое программирование принципом "данные как код", который приводит к тому, что архитектура описывается (и читается) декларативно как данные, но эти данные можно выполнять как код и получать полезнные для себя результаты, ввиде ответов на логические вопросы:

  - это правильная архитектура ?
  - если нет, почему ?
  - как сделать, что бы была правильная ?

Например, пусть у нас есть 2 системы - одна называется Аналитика, другая - Бухгалтерия. Пусть для каждой из систем заданы уровни критичности - для одной "очень", для другой "средне". И пусть для одной из систем указано RTO 24, а для другой 100. Опишем это как факты на  Prolog  в простом текстовом файле, назовем его kb-file.pl (наша маленькая база знаний).

```
:-discontiguous(система/1).
:-discontiguous(критичность/2).
:-discontiguous(rto/2).

система(аналитика).
система(бухгалтерия).
критичность(аналитика, очень).
критичность(бухгалтерия, средне).
rto(бухгалтерия, 24).
rto(фналитика, 100).
```

Это данные, которые читаются на русском языке. Prolog позволяет придумывать любые структуры и описывать их как удобно пользователю, что бы получилась удобная читаемость. Итак, данные читаются и их можно понять, но почему это код ? Эти данные можно выполнить и получить полезный для себя ответ. Например, я хочу узнать - какая система очень критична, но имеет RTO больше 25? Напишем этот запрос к своей базе знаний (которая описана в текстовом файле kb-file.pl), используя свои же придуманные структуры и даже на русском языке.

```
система(X), критичность(X, очень), rto(X, Y), Y>25 
```

![image](https://github.com/xantia88/logic/assets/52062122/44cf23ea-0b96-44b4-b889-d73f3fe6a73e)

В итоге, я получил результат, что такая система называется "аналитика" и rto у нее 100. Как видно на скрине, алгоритм работы с системой пролог очень простой и состоит из двух шагов: запустить систему командой swipl, попросить его загрузить базу знаний из текстового файла командой consult('kb-file.pl') и задать интересующий вопрос. Что бы привыкнуть к логическому программированию, нужно проговаривать про себя запросы, заменяя запятую на "и" или "у которой", например написанный запрос можно проговорить следующим образом: 

```
какая-то система Х, у которой критичность очень и какая-то RTO Y, которая больше 25
```
Важно понять эту концепцию, если данные - это код, то их можно и читать (глазами или сторонними средствами) и исполнять стандартными средствами, если же данные это просто данные, то их можно читать (глазами или сторонними средствами), но нельзя исполнять (к примеру, в базах данных для обработки данных есть специальные обработчики - язык SQL, реализация обработчка - отделено от данных). 

В этом проекте разработка модели ведется используя английские названия для предметной области - так проще, но интересной особенностью логического программирования, которая не нужна в этом проекте, является возможность создания синонимов для предикатов, т.е. сама модель остается как есть, а ее можно использовать в другой терминологии или на другом языке, например:

```
system(X):-
  система(X).

das_System(X):-
  система(X).
```

Этот код говорит о том, что систему можно определять и по-английски (system) и по-немецки (das_system). 

Вверху есть труднопроизносимое слово discontiguous, оно нужно что бы было постулировано описание единого языка базы знаний. И это очень важный момент, потому что с одной стороны невозможно создать логическую модель не сформировав язык этой модели, а с другой стороны внешние системы могут легко подключать логические модели (базы знаний) и запускать диалоги определив контекст по терминам. Например:

  - есть две базы знаний, и у каждой есть свой язык (пусть одна будет про микросервисы, а другая про техническую архитектуру)
  - система распознавания речи разбивает речь пользователя на слова и оценивает насколько набор произнесенных слов близок к языку микросервисов или к языку технической архитектуры
  - система подключает ту базу знаний к которой речь пользователя ближе и запускает интерактивные диалоги для уточнения деталей, сбора дополнительных знаний и ответа на пользоваетльские вопросы
  - у пользователя складывается впечатление, что система понимает контекст

Именно эта особенность позволяет разрабатывать саммообучающиеся (интеллектуальные) системы, т.к. логическая модель может порождать другую логическую модель (ппрограмма дописывает саму себя в процесссе обучения). Интеллектуальные диалоговые системы, сбор фактов, обучение (выстраивание фактов и отношений) - это именно та область где логическое программирование максимально эффективно. Системы логического программирования часто называют базами знаний, с которыми можно взаимодействовать в форме вопрос-ответ и диалогов. Они широко применяются при построении экспертных систем в медицине, транспорте, промышленности и военной сфере (например: диагностика двигателя самолета, постановка диагноза по анализам и симптомам, оптимизация маршрутов, проектирование здания с учетом особенностей среды и материалов).

В основе логики лежит понятие факта и отношений между ними. Мышление - это способность искать нужные знания (факты), связывать их между собой (отношения) и принимать решения на основе их взаимосвязей. Архитектурное мышление основано прежде всего на логике, все структуры (и динамические и статические), которыми оперирует архитектор - это набор фактов и отношений (например: диаграммы, шаблоны проектирования, шаблоны интеграции, стандарты). Архитектор - это эксперт, который работает со знаниями, структурами и логикой. Аналогично тому, как юрист и доктор работаю со знаниями, фактами и выводами. Архитектор должен использовать в своей работе подходящие профессиональные инструменты. Один из основных языков визуального проектирования архитектуры предприятия ArchiMate, использующийся в методологии Togaf полностью состоит из сущностей, аттрибутов и отношений.

https://pubs.opengroup.org/architecture/togaf9-doc/arch/chap30.html  

30.5 Content Metamodel Entities  
30.6 Content Metamodel Attributes  
30.7 Metamodel Relationships  

Логика и логическое программирование являются основой Computer Science и изучаются во всех технических вузах (ввиде языка Lisp или Scheme), но эпоха в которую мы живем - это эпоха автоматизации, т.е. сбора, передачи и анализа данных. Студенту гораздо проще начать уже на первом курсе писать мобильные приложения на Swift и Kotlin или интернет сайты на JavaScript и Python, чем применять на практике логическое программирование. Логических задач меньше чем задач по обработке данных, но они есть - и архитектурное проктирование одна из них, т.к. включает в себя и самообучающиеся диалоговые системы и логические выводы и автоматическое построение корректных структур (архитектурных решений). 

Не стоит обманываться, логическое программирование - не устаревший подход и не наукообразный, он очень прикладной и эффективный для определенных задач. Как видно из среза интересов сообщества на Reddit, логикой интересуются те, кто интересуется развитием технологий искусственного интеллекта. 

https://www.reddit.com/r/prolog/

Еще один пример от топового инкубатора стартапов Y Combinator, австрийское федеральное правительство использует Prolog для выдачи грантов компаниям. И это пример логической задачи - понять насколько компания соотвествует сложным критериям конкретных грантов. Задача аналогично архитектурной - понять насколько архитектура дочернего общества соотвествует не только стандартам заданным головной компанией, но и лучшим практикам. И кстати, этим занимается наш коллега - корпоративный архитектор, автор публикации (Philipp Marek, Enterprise & Security Architect).

https://www.brz.gv.at/en/BRZ-Tech-Blog/Tech-Blog-7-Symbolic-Analysis-of-Grants.html

https://news.ycombinator.com/item?id=34164221

Задачами данного проекта являются:

1. Описание архитектурной метамодели SEAF и SEAF ДЗО ввиде логической системы (факты, отношения, правила).
2. Создание диалоговых систем для взаимодействующих с пользователем с целью построения модели ахитектуры дочернего общества на базе метамодели родительской компании.
3. Формирование описание архитектуры на базе построенной модели дочернего общества в выбранном формате (YAML, SQL, ArchiMate).
4. Автоматическое формирование архитектурных решений и рекомендаций (модель, шаблоны проектирования, известные и неизвестные архитектурные объекты).

[Установка Prolog](https://github.com/xantia88/logic/wiki/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-Prolog)

### Ссылки 
  
  Основной сайт  
  https://www.swi-prolog.org/

  Среда для web  
  https://swish.swi-prolog.org/

  Хорошая книга:  
  Язык PROLOG (Пролог): алгоритмы искусственного интеллекта, Иван Братко  
  https://www.williamspublishing.com/Books/978-5-8459-0664-9.html
  
  
  
